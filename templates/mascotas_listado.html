{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="h4 mb-0">Mascotas de {{ especie.nombre }}</h2>
  {% if user.is_authenticated %}
    <a href="{% url 'mascota_nueva' %}" class="btn btn-success"><i class="bi bi-plus-circle me-1"></i>Nueva Mascota</a>
  {% else %}
    <a href="{% url 'login' %}?next={% url 'mascota_nueva' %}" class="btn btn-success">Inicia sesión para crear</a>
  {% endif %}
</div>

<form method="get" class="row g-2 mb-3">
  <div class="col-md-6">
    <input type="text" name="q" value="{{ q }}" class="form-control" placeholder="Buscar por nombre o apellido del dueño">
  </div>
  <div class="col-md-2">
    <button class="btn btn-outline-primary w-100"><i class="bi bi-search"></i> Buscar</button>
  </div>
</form>

<div class="row g-3">
  {% for m in mascotas %}
  <div class="col-12 col-md-6 col-lg-4">
    <div class="card product h-100 vet">
      {% if m.imagen %}<img src="{{ m.imagen.url }}" class="card-img-top" alt="{{ m.nombre }}">{% endif %}
      <div class="card-body">
        <h5 class="card-title mb-1">{{ m.nombre }}</h5>
        <div class="meta mb-2">
          <span class="me-2"><i class="bi bi-person-vcard me-1"></i>{{ m.dueno.nombres }} {{ m.dueno.apellidos }}</span>
          <span class="me-2"><i class="bi bi-gender-ambiguous me-1"></i>{{ m.get_sexo_display }}</span>
          <span><i class="bi bi-calendar3 me-1"></i>{{ m.edad }} años</span>
        </div>
        <div class="mt-auto d-flex gap-2">
          <a class="btn btn-sm btn-outline-primary" href="{% url 'mascota_detalle' m.id %}">Ver Detalles</a>
          <a class="btn btn-sm btn-warning" href="{% url 'mascota_editar' m.id %}">Editar</a>
          <a class="btn btn-sm btn-danger" href="{% url 'mascota_eliminar' m.id %}" onclick="return confirm('¿Eliminar mascota?');">Eliminar</a>
        </div>
      </div>
    </div>
  </div>
  {% empty %}
    <div class="col-12"><div class="alert alert-light border text-muted">Sin resultados</div></div>
  {% endfor %}
</div>
{% endblock %}
